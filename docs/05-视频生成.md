# 视频生成模块设计

## 视频规格

### 基础参数
- **分辨率**: 1080x1920 (竖屏) 或 1920x1080 (横屏)
- **时长**: 3-5分钟
- **帧率**: 30fps
- **编码**: H.264
- **音频**: AAC, 48kHz

### 平台适配
- 抖音/快手：1080x1920 (9:16)
- B站：1920x1080 (16:9)
- YouTube：1920x1080 (16:9)

## 生成流程

```
视频脚本 → 语音合成 → 字幕生成 → 
素材准备 → 视频合成 → 后期处理 → 输出
```

## 1. 文字转语音 (TTS)

### 技术方案选型

#### 方案A: Edge TTS (推荐)
- **优点**: 免费、音质好、支持多种中文音色
- **缺点**: 需要网络连接
- **成本**: 免费

```python
# 示例
import edge_tts

voice = "zh-CN-XiaoxiaoNeural"  # 晓晓（女声）
# 或 "zh-CN-YunxiNeural"         # 云希（男声）
```

#### 方案B: Azure TTS
- **优点**: 音质最佳、稳定性好
- **缺点**: 收费
- **成本**: ~$4/百万字符

#### 方案C: 本地TTS (PaddleSpeech)
- **优点**: 离线使用、无成本
- **缺点**: 音质一般、需要GPU加速

### 音色选择
- **新闻播报**: 使用专业、稳重的音色
- **亮点解读**: 使用活泼、有活力的音色
- **背景旁白**: 使用温和、平稳的音色

### 语音优化
- 添加适当停顿（逗号500ms，句号800ms）
- 调整语速（0.9x-1.1x）
- 调节音量和音调

## 2. 字幕生成

### 字幕样式
```python
subtitle_style = {
    "font": "Microsoft YaHei",      # 微软雅黑
    "size": 48,                      # 字号
    "color": "white",                # 白色
    "outline_color": "black",        # 黑色描边
    "outline_width": 3,              # 描边宽度
    "position": "bottom",            # 底部居中
    "margin": 100                    # 底部边距
}
```

### 字幕切分
- 按标点符号断句
- 每行最多15个字
- 与语音精确同步

### 字幕特效
- 逐字显示动画
- 关键词高亮（不同颜色）
- 进场/退场效果

## 3. 视觉素材

### 素材来源
1. **新闻配图**: 从爬取的文章中提取
2. **AI生成图片**: 使用DALL-E/Midjourney/Stable Diffusion
3. **素材库**: Unsplash, Pexels (免费商用)
4. **图标动画**: Lottie动画

### 画面布局模板

#### 模板1: 标题+配图
```
┌────────────────────┐
│    【今日AI速递】    │ ← 标题区
├────────────────────┤
│                    │
│    [配图/图片]      │ ← 内容区
│                    │
├────────────────────┤
│   字幕文字区域      │ ← 字幕区
└────────────────────┘
```

#### 模板2: 多图轮播
```
左侧：核心内容（70%）
右侧：要点列表（30%）
```

#### 模板3: 纯文字动画
- 关键信息以大字显示
- 动态效果（飞入、淡入等）

### 视觉风格
- **科技感**: 蓝色、紫色渐变背景
- **专业性**: 简洁的排版
- **动态性**: 适度的转场和动画

## 4. 视频合成

### 使用MoviePy
```python
from moviepy.editor import *

def create_video(script, audio, images):
    # 创建背景
    background = ColorClip(size=(1080,1920), 
                          color=(10,20,40))
    
    # 添加音频
    audio_clip = AudioFileClip(audio)
    
    # 添加图片
    image_clips = [ImageClip(img).set_duration(5) 
                   for img in images]
    
    # 添加字幕
    subtitles = create_subtitles(script)
    
    # 合成
    final = CompositeVideoClip([
        background,
        *image_clips,
        subtitles
    ]).set_audio(audio_clip)
    
    return final
```

### 转场效果
- 淡入淡出 (Fade)
- 滑动切换 (Slide)
- 缩放过渡 (Zoom)

### 性能优化
- 使用低分辨率预览
- 多线程处理
- GPU加速（如可用）

## 5. 后期处理

### 视频增强
- 音频降噪
- 音量归一化
- 色彩校正

### 添加片头片尾
```
片头（5秒）：Logo + 标题动画
正片（3-5分钟）：主要内容
片尾（5秒）：关注提示 + 二维码
```

### 添加背景音乐
- 轻音乐作为背景
- 音量控制在20-30%
- 避免干扰主要语音

## 6. 输出和发布

### 文件命名规范
```
AINews_YYYYMMDD_序号.mp4
例如：AINews_20260205_001.mp4
```

### 视频元数据
```python
metadata = {
    "title": "2026年2月5日 AI资讯速递",
    "description": "今日AI行业5大热点新闻...",
    "tags": ["AI", "人工智能", "科技资讯"],
    "category": "科技",
    "thumbnail": "封面图.jpg"
}
```

### 存储方案
- 本地存储：用于开发和备份
- 云存储（阿里云OSS/腾讯云COS）：用于生产
- CDN加速：用于分发

## 7. 批量生成

### 模板化
- 统一的视频模板
- 可配置的主题和样式
- 参数化的生成流程

### 自动化流程
```python
def auto_generate_daily_video():
    """每日自动生成流程"""
    # 1. 获取今日资讯总结
    articles = fetch_today_summaries()
    
    # 2. 生成视频脚本
    script = generate_script(articles)
    
    # 3. 文字转语音
    audio = text_to_speech(script)
    
    # 4. 准备视觉素材
    images = prepare_images(articles)
    
    # 5. 生成字幕
    subtitles = generate_subtitles(script)
    
    # 6. 合成视频
    video = compose_video(audio, images, subtitles)
    
    # 7. 发布
    publish_video(video)
```

## 性能指标

### 生成速度
- 3分钟视频预计生成时间：5-10分钟
- 可并行处理多个视频

### 质量标准
- 画面清晰度：1080p
- 音频清晰度：48kHz
- 字幕准确率：99%+
- 整体流畅度：无卡顿

## 未来扩展

### 高级功能
- AI数字人播报
- 实时数据可视化
- 互动式视频内容
- 多语言版本
