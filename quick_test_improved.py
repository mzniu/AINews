"""
å¿«é€Ÿæµ‹è¯•æ”¹è¿›åçš„GitHubæˆªå›¾æœåŠ¡
"""

import sys
from pathlib import Path
from services.selenium_screenshot_service import SyncSeleniumScreenshotService

def quick_test_improved_screenshot():
    """å¿«é€Ÿæµ‹è¯•æ”¹è¿›åçš„æˆªå›¾åŠŸèƒ½"""
    print("âš¡ å¿«é€Ÿæµ‹è¯•æ”¹è¿›åçš„GitHubæˆªå›¾æœåŠ¡")
    print("=" * 50)
    
    # æµ‹è¯•é¡¹ç›®URL
    test_url = "https://github.com/ZiYang-xie/WorldGen"
    
    # ç¡®ä¿è¾“å‡ºç›®å½•å­˜åœ¨
    Path('test_outputs').mkdir(exist_ok=True)
    
    print(f"æµ‹è¯•é¡¹ç›®: {test_url}")
    print("-" * 40)
    
    # ä½¿ç”¨æ”¹è¿›åçš„Seleniumæˆªå›¾æœåŠ¡
    print("ğŸ“¸ ä½¿ç”¨æ”¹è¿›åçš„Seleniumæˆªå›¾æœåŠ¡...")
    try:
        selenium_service = SyncSeleniumScreenshotService(headless=True)
        screenshot_path = Path('test_outputs/improved_screenshot.jpg')
        
        result = selenium_service.take_screenshot_sync(
            test_url,
            screenshot_path,
            width=1920,
            height=1080,
            wait_time=15,  # å¢åŠ ç­‰å¾…æ—¶é—´
            timeout=120    # å¢åŠ è¶…æ—¶æ—¶é—´
        )
        
        if result and screenshot_path.exists():
            size_kb = screenshot_path.stat().st_size / 1024
            print(f"âœ… æˆªå›¾æˆåŠŸ! æ–‡ä»¶å¤§å°: {size_kb:.1f} KB")
            print(f"ğŸ“ æ–‡ä»¶è·¯å¾„: {screenshot_path.absolute()}")
            print(f"\nğŸ” è¯·æ£€æŸ¥:")
            print(f"   1. StarsåŒºåŸŸæ˜¯å¦è¢«çº¢è‰²é«˜äº®æ¡†åŒ…å›´")
            print(f"   2. é¡µé¢å›¾ç‰‡æ˜¯å¦æ­£å¸¸æ˜¾ç¤º")
            print(f"   3. æ•´ä½“é¡µé¢å¸ƒå±€æ˜¯å¦å®Œæ•´")
            return True
        else:
            print("âŒ æˆªå›¾å¤±è´¥")
            return False
            
    except Exception as e:
        print(f"âŒ æµ‹è¯•å¼‚å¸¸: {e}")
        return False

def main():
    """ä¸»å‡½æ•°"""
    print("ğŸš€ GitHubæˆªå›¾æœåŠ¡å¿«é€Ÿæµ‹è¯•")
    print("=" * 60)
    
    success = quick_test_improved_screenshot()
    
    print(f"\n{'='*60}")
    if success:
        print("ğŸ‰ æµ‹è¯•æˆåŠŸ!")
        print("è¯·æŸ¥çœ‹ç”Ÿæˆçš„æˆªå›¾æ–‡ä»¶ç¡®è®¤æ•ˆæœ")
    else:
        print("âŒ æµ‹è¯•å¤±è´¥!")
        print("å»ºè®®æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæµè§ˆå™¨é©±åŠ¨")

if __name__ == "__main__":
    main()